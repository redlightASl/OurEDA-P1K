# OurEDA-P1K

一个水下机器人（ROV/AUV）的下位仓控制系统

请使用Arduino、CubeMX、CubeIDE访问相关代码，使用AD打开硬件原理图和PCB Layout设计

## 设计目的

当前中型水下作业机器人的最终升级方案

搭载三仓位、两套控制系统、多自由度机械臂式机器人解决方案

### 硬件外设

* 五自由度机械臂

    使用PID速度环进行精密控制，防水舵机驱动，理论可以达到很高的响应速度和精确度

    每个关节都搭载六轴传感器，可以通过ROS进行仿真

* 传送带机构

    耐磨损、高可靠性的传送带，防水舵机驱动，可调速

* 广角摄像头覆盖

    * 前置双目摄像头

        主要用于操作和AUV视觉控制

    * 斜向摄像头

        用于辅助测距、观察环境

    * 后置摄像头

        防止机器人发生磕碰或卡死在沙中

    * 置物仓摄像头

        用于观察舱内情况

* 六轴大功率推进器

* 开放框架结构

* 水深传感器、声呐高度传感器、水温传感器、声呐测距传感器

* 正交九轴传感器

    两个在舱内垂直布置的九轴传感器，当出现传感器数据失灵的情况下可以选择临时切换另一套传感器，平常情况下两个九轴数据融合解算得到当前机器人姿态

### 控制舱硬件

* Xilinx Zynq-7020

    PS部分搭载OpenWrt实现网络交换机功能

    PL部分实现一个RV32I指令集的MCU和一套CNN硬件加速器/硬件路由加速器

    * OpenWrt

        * 5 LAN口

            LAN0：上位机

            LAN1：主控FPGA

            LAN2：光通讯模块/声呐模块

            LAN3：网络摄像头

            LAN4：预留

        * 1 WAN口

            WAN0：可通过WiFi或转无线电连接到外网

        对外配置为路由器模式，对内配置为交换机模式

        整套系统可联网

    * MCU

        自研RV32IMADC标量五级流水线架构，优化性能-面积比，搭载自制的RTOS

        搭载Nitori ROV-OS，控制传感器收发

    * 硬件加速器

        实现传感器数据硬件解算

        可以执行YOLOv3算法或实现硬件路由
        
        用于代替TX2进行目标识别或其他更复杂任务

### 计算仓硬件

* Nvidia Jetson-TX2

    用于实现嵌入式目标识别算法

    AUV主控

### 电源仓硬件

* 220V转12V开关电源：提供2kW功率供电

* 应急电池/黑匣子

    在外部电源中断的情况下所有控制组件进入低功耗模式，主控保存最后收取传感器数据到SPI FLASH

* 12V转5V隔离电源模块：为主控系统供能

* 电调模块：为推进器提供6V大功率供电

* 8V稳压模块：为机械臂提供8V稳压供电

* 6V稳压模块：为其他舵机提供6V稳压供电

* 主控FPGA：基于Cortex-M3硬核的GW1NSR

    从上位机网口直接控制所有推进器、舵机、灯光PWM

    自带硬件PID和串口控制器

    同时将本仓的传感器数据接收处理后上传到上位机

    通过`192.168.0.2:101`端口访问

* 主控stm32h750

    用于部署复杂控制算法

    通过RT-Thread ROS与上位机串口通信



